# 作成したいプロジェクト

- ブラウザで動画のエンコードをするサイトを作成
- 画質設定を投稿出来るサービスを作成？

## メモ

- ブラウザエンコードで詳細に画質設定ができないなら、ffmpegの引数を指定？
- PHPサーバーでエンコードが指示できるならそれを実行する？
  - 流石にサーバー側にエンコードを投げるのは負荷が高すぎるからパス
- WebCodecs API(ブラウザ標準API)でエンコードさせるのが優秀そう

エンコードができないなら、コードの生成機能を付けたい。
Mediainfo.jsを内蔵させてファイル内容が確認できるようにもしたい。

# 一旦雑要件定義

# プロジェクト名

ブラウザでエンコードもできる動画エンコードサイト(仮)

# 実装機能

- ffmpeg.wasmとWebCodecs APIを選び、動画の圧縮(詳細設定可能)
- ffmpegのコード生成機能
- ffmpegコード保存、共有機能
- Mediainfo.jsを使ったフォーマット確認機能
- GoogleColabでのエンコードの支援機能(事前に使いやすいプロジェクトファイルを作成してGitHub gistにアップしておく)

### ✅ 実装予定機能 (Core Features)

**AIの成否に関わらず、ツールとして成立させるための基本機能群です。**

* **基本システム & UI**
  * **完全クライアントサイド処理:** FFmpeg.wasm および WebCodecs API を用いた動画変換・解析。
  * **Simple Mode (UI):** ファイル選択、プリセットボタン（スマホ用/添付用など）、実行ボタンのみのシンプル画面。
  * **Geek Mode (UI):** トグルスイッチによる画面展開（ダッシュボード・コンソール表示）。
  * **PWA対応:** オフライン動作、インストール機能。
  * **Tailscale対応:** 開発環境におけるHTTPS/MagicDNS利用。
* **ロジック & 制御**
  * **プリセット制御:** ルールベース（ハードコード）による「松・竹・梅」設定の適用。
  * **JSONテンプレートエンジン:** パラメータ（JSON）を受け取り、FFmpegコマンド文字列に変換する安全な仕組み。
  * **メモリ管理:** モバイル端末等でのクラッシュを防ぐBlob解放・監視ロジック。
* **可視化 (Geek Dashboard)**
  * **圧縮率ビジュアライザー:** 元サイズ vs 変換後サイズのバーグラフ比較。
  * **詳細メディア解析:** MediaInfo.js を用いたメタデータ表示。
  * **処理グラフ:** ビットレート推移、処理FPSの波形表示。
* **共有・エクスポート (The Souvenir)**
  * **QRコード生成:** 成功したFFmpegコマンドをQR化して表示。
  * **Colab Notebook生成:** 処理内容を再現する `.ipynb` ファイルの動的生成。
  * **Litterbox連携:** 生成したNotebookをAPI経由で一時共有サーバーへアップロードし、URL（QR）を発行。

---

### ⚠️ 条件付き実装機能 (PoC Features)

**「Gemini Nano等の技術検証」に成功した場合のみ実装します。失敗時は実装しません。**

* **AIインテリジェンス**
  * **Gemini Nano (window.ai) 連携:** ブラウザ内蔵AIによる推論実行。
  * **Adaptive Strategy (適応型制御):** AI性能に応じて「安全なJSON生成」と「高度なコマンド生成」を切り替えるロジック。
  * **自然言語指示:** 「画質維持で軽くして」等のテキスト入力をパラメータに変換する機能。
* **高度な演出 (Wow Factor)**
  * **Raw Command生成:** AIが直接FFmpegの引数（フィルタチェーン等）を書く機能。
  * **Self-Healing (自己修復):** エラー発生時にAIがログを読み、コマンドを修正して再実行するプロセス。
  * **実況解説コンソール:** Self-Healingの思考プロセス（「エラー検知…修正案を作成中…」）をログとして流す演出。
  * **AI Monitor:** ダッシュボードへの推論速度(t/s)やメモリ使用量の表示。

---

### ❌ 未実装・除外機能 (Out of Scope)

**検討の末、リスク回避やスコープ外として「やらない」と決めた機能です。**

* **アカウント・連携関連**
  * **GitHub Gist連携:** アカウント管理の手間とトークン漏洩リスク回避のため **廃止** 。
  * **ユーザーログイン機能:** 展示会での利用（一見さん）を前提とするため不要。
* **処理・インフラ関連**
  * **サーバーサイドエンコード:** サーバー負荷とコスト回避のため、バックエンドでの動画処理は **一切行わない** 。
  * **DBによる永続化:** ユーザーデータの保存は行わない（Litterboxへの一時アップロードのみ）。
* **その他**
  * **複雑な動画編集:** カット、結合、テロップ入れなどは対象外（あくまで「Optimizer/Converter」に特化）。
