# ブラウザのみで動画エンコードを実現するWebアプリ企画書

## 1. プロジェクト概要
- **タイトル**：ブラウザのみで動画エンコードを実現するWebアプリ
- **目的**：サーバーサイド処理を最小限にし、ブラウザ単体で動画エンコードをどこまで実現できるか検証する。
- **背景**：
  - 課題要件として PHP / MySQL / MVC を使用する必要があるため、掲示板機能で DB 要件を満たしつつ、趣味の動画エンコードをテーマに選定。
  - 開発効率化のため、UI設計やパラメータ調整にAIエージェントの支援を一部活用。
- **ゴール**：
  - ブラウザのみで 1080p 動画をエンコードし、ダウンロード可能な Web アプリを構築。
  - 掲示板機能でエンコード設定を共有・比較できる。

## 2. ターゲットユーザー
- 動画編集初心者（簡単操作でエンコードしたい）
- 開発者（WebCodecs API の技術検証目的）

## 3. 使用環境
- **クライアント**：Windows PC（最新ブラウザ：Chrome推奨）
- **サーバー**：自前サーバー（PHP + MySQL）

## 4. 機能要件
### Tier1（必須）
- 動画アップロード
  - 目的：ユーザーが動画を選択し、メタ情報を確認できる
  - 入力：動画ファイル（MP4/WebM）
  - 出力：メタ情報（解像度・ビットレート）、サムネイル画像

- プリセット選択
  - 目的：簡単にエンコード設定を選択できる
  - 入力：プリセット名（HQ / Standard / Low Size / Mobile / Ultra Compact）
  - 出力：設定済みエンコードパラメータ（JSON）

- カスタム設定
  - 目的：詳細なエンコードパラメータを指定可能にする
  - 入力：解像度、ビットレート、コーデック
  - 出力：カスタム設定パラメータ（JSON）

- プレビュー生成
  - 目的：短いクリップで設定を確認できる
  - 入力：動画ファイル＋設定パラメータ
  - 出力：プレビュー動画

- エンコード実行
  - 目的：WebCodecs APIを利用して動画をエンコード
  - 入力：動画ファイル＋設定パラメータ
  - 出力：エンコード済み動画ファイル

- ダウンロード機能
  - 目的：エンコード後の動画を取得できる
  - 入力：エンコード済み動画
  - 出力：ローカル保存

- 掲示板投稿
  - 目的：エンコード設定とコメントを共有
  - 入力：設定JSON＋コメント
  - 出力：掲示板に投稿表示

### Tier2（余裕があれば）
- 掲示板でパラメータ比較機能
  - 目的：複数のエンコード設定を比較し、最適な設定を見つける
  - 入力：掲示板投稿データ（JSON形式のエンコード設定）
  - 出力：比較結果（表形式）

- 投票機能
  - 目的：ユーザーが好みの設定に投票できる
  - 入力：ユーザー選択（投稿ID）
  - 出力：投票数の集計結果

## 5. UIデザイン方針
- **OneUI風デザイン**：
  - カード型UI（角丸＋影）
  - モバイルライクな余白と大きめボタン
  - ライトテーマ＋柔らかい配色
- **掲示板オフライン時**：
  - 「接続できません」メッセージ表示
  - 掲示板全体をグレーアウト

## 6. 技術構成
- **フロントエンド**：
  - Svelte（UI）
  - WebCodecs API（動画エンコード）
  - MP4Box.js（MP4 Mux）
  - jswebm（WebM Mux）
  - Service Worker（オフライン時は掲示板無効化）
- **サーバーサイド**：
  - PHP（MVC構成）
  - MySQL（掲示板データ管理）
- **技術制約**：
  - WebCodecs は Chrome 系ブラウザ推奨（Firefox/Safari は未対応機能あり）
  - ハードウェアアクセラレーションは環境依存
  - AV1 エンコードは処理が重い

## 7. UI操作フロー（ASCII図）
[アップロード] -> [設定] -> [プレビュー] -> [エンコード] -> [ダウンロード] -> [掲示板投稿]

## 8. ワークフロー
アップロード → 設定 → プレビュー → エンコード → ダウンロード → 掲示板投稿

## 9. 課題とリスク＋対策案
- WebCodecs のブラウザ対応範囲 → Chrome推奨、非対応機能は警告表示
- エンコード速度（特に AV1） → プリセットで負荷軽減、UIで注意喚起
- ユーザーの操作性（UIの複雑さ） → AI提案でUI改善
- 掲示板のセキュリティ（XSS対策） → htmlspecialchars()でエスケープ

## 10. 開発スケジュール（簡易）
- **Week 1**：UI設計（ワイヤーフレーム完成、AI支援）
- **Week 2-3**：エンコード機能実装（WebCodecs＋Mux処理）
- **Week 4**：掲示板機能実装
- **Week 5**：テスト・ブラウザ互換性確認
